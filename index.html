<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>enWords</title>
    <style>
      * {
        padding: 0;
        margin: 0;
        color: white;
        font-size: 15px;
        font-family: sans-serif;
        font-weight: bold;
        text-align: center;
        line-height: 1.3;
      }

      html {
        width: 100%;
        height: 100%;
      }

      body {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #00004f;
      }

      button {
        border: none;
        outline: none;
        cursor: pointer;
        font-size: 1.5rem;
        border-radius: 15%;
      }

      button:active {
        opacity: 0.5;
      }

      #elapsedTime {
        position: absolute;
        top: 0;
        font-size: 0.8rem;
      }

      #wrapper {
        width: 340px;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }

      #topNav {
        width: 100%;
        display: flex;
        justify-content: space-around;
        align-items: center;
        flex-direction: row;
        margin-top: 10px;
      }

      #topNav > button {
        width: 44px;
        height: 44px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #mode1Button,
      #mode2Button,
      #mode3Button,
      #mode4Button {
        background: #ffffff1a;
        font-size: 1.2rem;
      }

      #listOfWords {
        background: transparent;
        border: 2px solid #ffffff70;
        font-size: 1.2rem;
      }

      #bottomNav {
        width: 100%;
        display: flex;
        justify-content: space-around;
        align-items: center;
        flex-direction: row;
        margin-bottom: 10px;
      }

      #bottomNav > button {
        width: 100px;
        height: 100px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #addButton {
        background: #ffffff1f;
      }

      #countButton {
        background: transparent;
        border: 2px solid #ffffff70;
      }

      #nextButton {
        background: #14147a;
      }

      #div1,
      #div3 {
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex: 1;
      }

      #div1 span {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: flex-end;
        font-size: 3.2rem;
        color: #ffffffe8;
      }

      #div3 span {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        font-size: 3.2rem;
      }

      #div2 {
        width: 100vw;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #div2 span {
        width: 100%;
        height: 100px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 3.2rem;
        background: #14147a;
        margin: 20px 0;
      }

      .small-font {
        font-size: 2.5rem;
      }

      #tableDiv {
        display: none;
        position: absolute;
        top: 70px;
        width: 340px;
        height: calc(100% - 72px);
        z-index: 2;
        overflow-y: scroll;
        overflow-x: hidden;
        background: #00004f;
      }

      table {
        table-layout: fixed;
        width: 100%;
        font-size: 0.9rem;
      }

      td {
        width: 100%;
        padding: 10px 5px;
      }

      tbody tr:nth-child(odd) {
        background: #ffffff17;
      }
    </style>
  </head>

  <body>
    <div id="elapsedTime"></div>
    <div id="wrapper">
      <div id="topNav">
        <button id="mode1Button">1</button>
        <button id="mode2Button">2</button>
        <button id="mode3Button">3</button>
        <button id="mode4Button">4</button>
        <button id="listOfWords">w</button>
      </div>
      <div id="div1"><span></span></div>
      <div id="div2"><span></span></div>
      <div id="div3"><span></span></div>
      <div id="bottomNav">
        <button id="addButton">NO</button>
        <button id="countButton">0</button>
        <button id="nextButton">OK</button>
      </div>
    </div>
    <div id="tableDiv" style="display: none"></div>
    <input type="hidden" id="modeInput" value="1" />
    <script>
      // array
      const wordsArray = [
        ['be', 'би', 'быть'],
        ['bring', 'бринг', 'принести'],
        ['buy', 'бай', 'купить'],
        ['call', 'кол', 'звонить'],
        ['cost', 'кост', 'стоить'],
        ['do', 'ду', 'делать'],
        ['dream', 'дрим', 'мечтать'],
        ['drink', 'дринк', 'пить'],
        ['drive', 'драйв', 'водить'],
        ['eat', 'ит', 'кушать'],
        ['feel', 'фил', 'чувствовать'],
        ['forget', 'фогЭт', 'забыть'],
        ['get', 'гэт', 'получить'],
        ['give', 'гив', 'дать'],
        ['have', 'хэв', 'иметь'],
        ['know', 'нОу', 'знать'],
        ['learn', 'лёрн', 'учиться'],
        ['make', 'мэйк', 'сделать'],
        ['meet', 'мит', 'встретить'],
        ['pay', 'пэй', 'платить'],
        ['play', 'плэй', 'играть'],
        ['put', 'пут', 'класть'],
        ['read', 'рид', 'читать'],
        ['see', 'си', 'видеть'],
        ['sell', 'сэл', 'продать'],
        ['send', 'сэнд', 'слать'],
        ['sleep', 'слип', 'спать'],
        ['speak', 'спик', 'говорить'],
        ['take', 'тэйк', 'брать'],
        ['teach', 'тич', 'учить'],
        ['tell', 'тэл', 'сказать'],
        ['think', 'синк', 'думать'],
        ['try', 'трай', 'стараться'],
        ['write', 'райт', 'писать'],
        ['wait', 'вэйт', 'ждать'],
        ['become', 'бикАм', 'стать'],
        ['begin', 'бигИн', 'начать'],
        ['choose', 'чуз', 'выбрать'],
        ['come', 'кам', 'прийти'],
        ['cut', 'кат', 'резать'],
        ['find', 'файнд', 'найти'],
        ['dryer', 'дрАер', 'сушилка'],
        ['fly', 'флай', 'лететь'],
        ['hear', 'хИа', 'слышать'],
        ['hold', 'холд', 'держать'],
        ['later', 'лЭйтэр', 'позже'],
        ['leave', 'лив', 'оставить'],
        ['lie', 'лай', 'лежать'],
        ['run', 'ран', 'бежать'],
        ['show', 'шОу', 'показать'],
        ['sit', 'сит', 'сидеть'],
        ['swim', 'свим', 'плыть'],
        ['wake up', 'вЭйк ап', 'проснуться'],
        ['win', 'вин', 'выиграть'],
        ['new', 'нью', 'новый'],
        ['now', 'нАу', 'сейчас'],
        ['high', 'хай', 'высокий'],
        ['old', 'олд', 'старый'],
        ['long', 'лонг', 'длинный'],
        ['little', 'литл', 'маленький'],
        ['bad', 'бэд', 'плохой'],
        ['best', 'бэст', 'лучший'],
        ['right', 'райт', 'правильно'],
        ['only', 'Онли', 'только'],
        ['low', 'лОу', 'низкий'],
        ['early', 'Ёрли', 'рано'],
        ['late', 'лЭйт', 'поздно'],
        ['hard', 'хард', 'жесткий'],
        ['strong', 'стронг', 'сильный'],
        ['free', 'фри', 'свободный'],
        ['full', 'фул', 'полный'],
        ['recently', 'рИсэнтли', 'недавно'],
        ['open', 'Оупн', 'открыть'],
        ['wrong', 'ронг', 'неправильно'],
        ['similar', 'сИмилар', 'похожий'],
        ['hot', 'хот', 'горячий'],
        ['happy', 'хэпи', 'счастлив'],
        ['ready', 'рЭди', 'готовый'],
        ['dark', 'дарк', 'темный'],
        ['cold', 'колд', 'холодный'],
        ['main', 'мэйн', 'главный'],
        ['huge', 'хьюдж', 'огромный'],
        ['everything', 'Эврисинг', 'всё'],
        ['nothing', 'нАсинг', 'ничего'],
        ['every', 'Эври', 'каждый'],
        ['thing', 'синг', 'вещь'],
        ['all', 'ол', 'все'],
        ['happen', 'хЭпн', 'случается'],
        ['thread', 'трэд', 'нить'],
        ['item', 'Айтэм', 'предмет'],
        ['slow', 'слОу', 'медленный'],
        ['fast', 'фаст', 'быстро'],
        ['sure', 'шУа', 'конечно'],
        ['already', 'олрЭди', 'уже'],
        ['yet', 'йЕт', 'еще'],
        ['ask', 'аск', 'спросить'],
        ['spend', 'спэнд', 'тратить'],
        ['change', 'чейндж', 'менять'],
        ['move', 'мув', 'двигать'],
        ['enjoy', 'энджОй', 'наслаждаться'],
        ['sometimes', 'самтАймс', 'иногда'],
        ['must', 'маст', 'должен'],
        ['want', 'вОнт', 'хотеть'],
        ['need', 'нид', 'нужно'],
        ['week', 'вик', 'неделя'],
        ['month', 'манс', 'месяц'],
        ['hour', 'Ауэр', 'час'],
        ['price', 'прайс', 'цена'],
        ['agree', 'эгрИ', 'согласиться'],
        ['look for', 'лук фор', 'искать'],
        ['funny', 'фАни', 'забавный'],
        ['fine', 'файн', 'хорошо'],
        ['feed', 'фид', 'кормить'],
        ['break', 'брэйк', 'разбить'],
        ['anytime', 'энитАйм', 'в любое время'],
        ['catch', 'кэч', 'поймать'],
        ['use', 'юз', 'использую'],
      ];

      const wordsArrayQuestion = [
        ['how many', 'хАу мЭни', 'сколько (исч)'],
        ['how much', 'хАу мач', 'сколько'],
        ['what for', 'ват фор', 'зачем'],
        ['when', 'вэн', 'когда'],
        ['where', 'вЭа', 'где, куда'],
        ['who', 'ху', 'кто'],
        ['why', 'вай', 'почему'],
        ['what', 'ват', 'что'],
        ['which', 'уИч', 'который'],
        ['how', 'хАу', 'как'],
        ['whose', 'хуз', 'чей'],
      ];

      const wordsArrayLong = [
        ['Я ищу автобусную остановку. Скажите пожалуйста где она'],
        ['Можно посмотреть ту коричневую сумку пожалуйста?'],
        ['Сколько стоит этот пиджак?'],
        ['Отлично, наконец-то пятница. Время идти домой'],
        ['Сколько остановок до 11-й авеню?'],
        ['Скажите мне пожалуйста когда мы прибываем в Монреаль?'],
        ['Мне нужен билет на сегодня, где я могу купить его?'],
        ['Извини, я тебя не расслышал. Скажи снова пожалуйста'],
        ['Могу я спросить у вас что-то? Как называется это дерево?'],
        ['Спасибо за информацию'],
        ['Я учу английский каждый день, но не на уикенд'],
        ['Я согласна. Первый сезон этого тв шоу был лучший'],
        ['Я недавно поменяла нитки от белой к зеленой. Все работает хорошо'],
        ['Я могу отнести коробку в комнату завтра или сейчас'],
        ['Клиент ждет тебя возле кухни'],
        ['Я оставлю это здесь, ты можешь брать в любое время'],
      ];

      // Create a deep copy of the wordsArray
      const deepCopyArray = JSON.parse(JSON.stringify(wordsArray));

      // Sort the deep copy by the second word in each pair
      deepCopyArray.sort(function (a, b) {
        return a[1].localeCompare(b[1]);
      });

      const sortedArray = wordsArray.sort(function (a, b) {
        return a[2].localeCompare(b[2]);
      });

      // Fisher-Yates shuffle algorithm
      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      // Shuffle the sorted deep copy on page load
      shuffle(deepCopyArray);
      shuffle(wordsArrayQuestion);
      shuffle(wordsArrayLong);

      let currentIndex = 0;
      let newIndex = 0;
      let mode = 1;
      let newArray = [];

      // Store references to the elements in variables
      const htmlQ = document.querySelector('html');
      const body = document.querySelector('body');
      const wrapper = document.getElementById('wrapper');
      const div1 = document.querySelector('#div1 span');
      const div2 = document.querySelector('#div2 span');
      const div3 = document.querySelector('#div3 span');
      const div33 = document.querySelector('#div3');
      const topNav = document.getElementById('topNav');
      const mode1Button = document.getElementById('mode1Button');
      const mode2Button = document.getElementById('mode2Button');
      const mode3Button = document.getElementById('mode3Button');
      const mode4Button = document.getElementById('mode4Button');
      const listOfWords = document.getElementById('listOfWords');
      const bottomNav = document.getElementById('bottomNav');
      const addButton = document.getElementById('addButton');
      const countButton = document.getElementById('countButton');
      const nextButton = document.getElementById('nextButton');
      const modeInput = document.getElementById('modeInput');

      hideThis(div2);

      console.log(currentIndex);

      function mode1() {
        div1.innerText = deepCopyArray[currentIndex][0];
        div2.innerText = deepCopyArray[currentIndex][2];
        div3.innerText = deepCopyArray[currentIndex][1];
      }

      function newArrayMode() {
        if (newArray.length === 0) {
          console.log('no words yet');
        } else {
          div1.innerText = newArray[newIndex][0];
          div2.innerText = newArray[newIndex][2];
          div3.innerText = newArray[newIndex][1];
        }
      }

      function newArrayMode2() {
        if (newArray.length === 0) {
          console.log('no words yet');
        } else {
          div1.innerText = newArray[newIndex][2];
          div2.innerText = newArray[newIndex][0];
          div3.innerText = newArray[newIndex][1];
        }
      }

      function mode2() {
        div1.innerText = deepCopyArray[currentIndex][2];
        div2.innerText = deepCopyArray[currentIndex][0];
        div3.innerText = deepCopyArray[currentIndex][1];
      }

      function mode3() {
        if (currentIndex >= wordsArrayQuestion.length) {
          currentIndex = 0;
        }

        div1.innerText = wordsArrayQuestion[currentIndex][0];
        div2.innerText = wordsArrayQuestion[currentIndex][2];
        div3.innerText = wordsArrayQuestion[currentIndex][1];
      }

      function mode4() {
        if (currentIndex >= wordsArrayLong.length) {
          currentIndex = 0;
        }

        div1.innerText = wordsArrayLong[currentIndex][0];
      }

      // ===== NEXT =====
      nextButton.addEventListener('click', function () {
        //
        hideThis(div2);

        if (currentIndex >= deepCopyArray.length) {
          currentIndex = 0; // Reset to cycle through the words again
        }

        console.log(modeInput.value);

        if (modeInput.value === '1') {
          mode1();
          nextButton.innerHTML = deepCopyArray.length - currentIndex;
        } else if (modeInput.value === '2') {
          mode2();
          nextButton.innerHTML = deepCopyArray.length - currentIndex;
        } else if (modeInput.value === '3') {
          mode3();
          nextButton.innerHTML = wordsArrayQuestion.length - currentIndex;
        } else if (modeInput.value === '4') {
          mode4();
          nextButton.innerHTML = 'OK';
        }

        // divs visibility
        if (modeInput.value === '1' || modeInput.value === '3') {
          showThis(div1);
          showThis(div3);
          showThis(div33);
          hideThis(div2);
        } else if (modeInput.value === '2') {
          hideThis(div3);
          hideThis(div33);
          div1.style.alignItems = 'center';
        } else if (modeInput.value === '4') {
          hideThis(div33);
        }

        currentIndex++;
      });

      // ===== COUNT =====
      countButton.addEventListener('click', function () {
        //
        hideThis(div2);

        if (newIndex >= newArray.length) {
          newIndex = 0; // Reset to cycle through the words again
        }

        if (modeInput.value === '1') {
          newArrayMode();
        } else if (modeInput.value === '2') {
          hideThis(div3);
          hideThis(div33);
          newArrayMode2();
          div1.style.alignItems = 'center';
        } else {
          newArrayMode();
        }

        newIndex++;
      });

      // ===== ADD =====
      addButton.addEventListener('click', function () {
        //
        newIndex = 0;

        const currentWord =
          deepCopyArray[
            currentIndex > 0 ? currentIndex - 1 : deepCopyArray.length - 1
          ][0];
        if (
          currentIndex > 0 &&
          !newArray.some(function (pair) {
            return pair[0] === currentWord;
          })
        ) {
          newArray.push(deepCopyArray[currentIndex - 1]);
        }

        updateCountButton(); // Update the count button text
      });

      mode1Button.addEventListener('click', function () {
        modeInput.value = 1;
        switchMode(1);
        colorMode1();
        clearAll();
        updateCountButton();
        addButton.style.display = 'flex';
        countButton.style.display = 'flex';
      });

      mode2Button.addEventListener('click', function () {
        modeInput.value = 2;
        switchMode(2);
        colorMode2();
        clearAll();
        updateCountButton();
        addButton.style.display = 'flex';
        countButton.style.display = 'flex';
      });

      mode3Button.addEventListener('click', function () {
        modeInput.value = 3;
        switchMode(3);
        colorMode3();
        clearAll();
        updateCountButton();
        addButton.style.display = 'none';
        countButton.style.display = 'none';
      });

      mode4Button.addEventListener('click', function () {
        modeInput.value = 4;
        switchMode(4);
        colorMode4();
        clearAll();
        updateCountButton();
        addButton.style.display = 'none';
        countButton.style.display = 'none';
      });

      // ===== MODE ====
      function switchMode() {
        const mode = modeInput.value;

        if (modeInput.value === '4') {
          div1.style.fontSize = '2.5rem';
        } else {
          div1.style.fontSize = '';
        }

        if (modeInput.value === '1' || modeInput.value === '3') {
          div1.style.alignItems = '';
          div3.style.alignItems = '';
        }

        if (modeInput.value === '2' || modeInput.value === '4') {
          div1.style.alignItems = 'center';
          div3.style.alignItems = 'center';
        }

        console.log(modeInput.value);
      }

      modeInput.addEventListener('change', function () {
        switchMode();
      });

      // Show translation

      div1.addEventListener('click', function () {
        if (currentIndex !== 0) {
          if (modeInput.value === '1' || modeInput.value === '3') {
            showThis(div2);
          } else if (modeInput.value === '2') {
            showThis(div2);
            showThis(div3);
            showThis(div33);

            div1.style.alignItems = '';
            div3.style.alignItems = '';
          }
        }
      });

      div3.addEventListener('click', function () {
        if (currentIndex !== 0) {
          if (modeInput.value === '1' || modeInput.value === '3') {
            showThis(div2);
          }
        }
      });

      div33.addEventListener('click', function () {
        if (currentIndex !== 0) {
          if (modeInput.value === '2') {
            showThis(div2);
            showThis(div3);
          }
        }
      });

      // hide
      function hideThis(me) {
        me.style.display = 'none';
      }

      // show
      function showThis(me) {
        me.style.display = 'flex';
      }

      function updateCountButton() {
        countButton.innerText = newArray.length;
      }

      // clear everything
      function clearAll() {
        currentIndex = 0;
        newIndex = 0;
        newArray.length = 0;
        div1.innerHTML = '';
        div2.innerHTML = '';
        div3.innerHTML = '';
        nextButton.innerHTML = 'OK';
        hideThis(div2);
      }

      // color scheme mode 1
      function colorMode1() {
        htmlQ.style.filter = '';
      }

      // color scheme mode 2
      function colorMode2() {
        htmlQ.style.filter = 'hue-rotate(40deg)';
      }

      // color scheme mode 3
      function colorMode3() {
        htmlQ.style.filter = 'hue-rotate(250deg)';
      }

      // color scheme mode 4
      function colorMode4() {
        htmlQ.style.filter = 'hue-rotate(140deg)';
      }

      //create a Table Object
      let table = document.createElement('table');
      table.setAttribute('id', 'table');
      //table.setAttribute("style", "display: none");
      //iterate over every array(row) within tableArr
      for (let row of sortedArray) {
        //Insert a new row element into the table element
        table.insertRow();
        //Iterate over every index(cell) in each array(row)
        for (let cell of row) {
          //While iterating over the index(cell)
          //insert a cell into the table element
          let newCell = table.rows[table.rows.length - 1].insertCell();
          //add text to the created cell element
          newCell.innerHTML = cell;
        }
      }
      //append the compiled table to the DOM
      let targetDiv = document.querySelector('#tableDiv');
      targetDiv.appendChild(table);

      // Show - hide table
      listOfWords.addEventListener('click', showTable);

      function showTable() {
        let x = document.querySelector('#tableDiv');
        if (x.style.display === 'none') {
          x.style.display = 'block';
        } else {
          x.style.display = 'none';
        }
      }

      //remove ALL listeners
      function listenersClear() {
        document.querySelectorAll('*').forEach((element) => {
          element.removeEventListener('click', handleEvent); // Replace 'click' with the desired event type
        });
      }

      // Check the mode every 100 milliseconds
      /*   function checkMode() {
        const mode = modeInput.value;
        console.log('Current mode:', mode);
        // Do something with the mode value

        // font size
        if (modeInput.value === '4') {
          div1.style.fontSize = '2.5rem';
        } else {
          div1.style.fontSize = '';
        }
      }
      setInterval(checkMode, 100); */
    </script>
  </body>
</html>
